function close_command(){var e=window.localStorage.getItem("BearerToken");$.ajax({url:$apiUrl+"/command/"+window.localStorage.getItem("command_id"),headers:{Authorization:`Bearer ${e}`},type:"PUT",data:{command_status_id:1},async:!1,dataType:"json",success:function(e){window.localStorage.removeItem("command_id"),window.localStorage.removeItem("command_qty"),console.log(e)},error:function(e){console.log(e)}})}function put_customer(){var e=window.localStorage.getItem("BearerToken");let o={customer_id:window.localStorage.getItem("customer_id")};$.ajax({url:$apiUrl+"/user/"+window.localStorage.getItem("user_id"),headers:{Authorization:`Bearer ${e}`},type:"PUT",data:o,dataType:"json",success:function(e){console.log(e),window.localStorage.removeItem("command_id"),window.localStorage.removeItem("command_qty"),swal("Bravo!","Vous Ãªtes inscrit!","success").then(e=>{window.location=$webUrl+"/choice"})}})}function post_customer(){var e=window.localStorage.getItem("BearerToken");let o={user_id:window.localStorage.getItem("user_id")};$.ajax({url:$apiUrl+"/customer",headers:{Authorization:`Bearer ${e}`},type:"POST",data:o,dataType:"json",success:function(e){window.localStorage.removeItem("customer_id"),window.localStorage.setItem("customer_id",e.id),put_customer(),console.log(e)}})}function put_cooker(){var e=window.localStorage.getItem("BearerToken");let o={cooker_id:window.localStorage.getItem("cooker_id")};$.ajax({url:$apiUrl+"/user/"+window.localStorage.getItem("user_id"),headers:{Authorization:`Bearer ${e}`},type:"PUT",data:o,dataType:"json",success:function(e){console.log(e),post_customer()}})}function post_cooker(){var e=window.localStorage.getItem("BearerToken");let o={user_id:window.localStorage.getItem("user_id")};$.ajax({url:$apiUrl+"/cooker",headers:{Authorization:`Bearer ${e}`},type:"POST",data:o,dataType:"json",success:function(e){window.localStorage.removeItem("cooker_id"),window.localStorage.setItem("cooker_id",e.id),put_cooker()},error:function(e){console.log(e)}})}function get_register(e){var o=e.bearerToken;if(console.log(o),o){window.localStorage.removeItem("BearerToken"),window.localStorage.setItem("BearerToken",o);var t=window.localStorage.getItem("BearerToken");$.ajax({url:$apiUrl+"/user/current/"+$("#auth-mail").val(),headers:{Authorization:`Bearer ${t}`},type:"GET",dataType:"json",success:function(e){window.localStorage.removeItem("user_id"),window.localStorage.setItem("user_id",e.id),post_cooker()}})}}function post_register(){let e={email:$("#auth-mail").val(),password:$("#auth-password").val(),password_confirmation:$("#auth-password-confirmation").val(),first_name:$("#auth-first-name").val(),last_name:$("#auth-last-name").val()};$.ajax({type:"POST",url:$apiUrl+"/user/register",data:e,success:function(e){get_register(e)},error:function(e){alert(e.responseText),console.log(e)}})}$(document).ready(function(){close_command(),$("#register-btn").click(function(){post_register()})});

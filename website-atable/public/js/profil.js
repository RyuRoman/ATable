var dish_list,token=window.localStorage.getItem("BearerToken");function build_headder(e){var a,o;$.ajax({url:$apiUrl+"/cooker/"+window.localStorage.getItem("cooker_id"),headers:{Authorization:`Bearer ${token}`},type:"GET",async:!1,dataType:"json",success:function(e){0==e.delivery?(a="Takeaway",o="Delivery"):(a="Delivery",o="Takeaway"),console.log(e)}}),console.log("HELLO");var t='<div class="row d-flex mb-5 contact-info">'+('<div class="col-md-3 d-flex"><div class="info bg-white p-4"><p><span>Email:<br></span> <a href="mailto:info@yoursite.com">'+e.email+"</a></p></div></div>")+('<div class="col-md-3 d-flex"><div class="info bg-white p-4"><p><span>Date de naissance:</span> <a href="tel://1234567920"><br>'+e.date_of_birth+'</a></p><p><a id="bday-btn" class="btn btn-primary" style="color:white;">Modifier</a></p></div></div>')+('<div class="col-md-3 d-flex"><div class="info bg-white p-4"><p><span>Téléphone:</span> <a href="tel://1234567920"><br>'+e.phone+'</a></p><p><a id="phone-btn" class="btn btn-primary" style="color:white;">Modifier</a></p></div></div>')+('<div class="col-md-3 d-flex"><div class="info bg-white p-4"><p><span>Delivery / Takeaway:<br></span> <a href="#">'+a+'</a></p><p><a id="delivery-btn" class="btn btn-primary" style="color:white;">Changer en '+o+"</a></p></div></div>")+'<div class="w-100"></div></div>';$("#profil_info").html(t),$("#bday-btn").click(function(){swal("Quelle est votre date de naissance ? (yyyy-mm-dd)",{content:"input"}).then(e=>{if(e){let a={date_of_birth:e};$.ajax({url:$apiUrl+"/user/"+window.localStorage.getItem("user_id"),headers:{Authorization:`Bearer ${token}`},type:"PUT",data:a,dataType:"json",success:function(a){console.log(a),swal("Succès!","Vous êtes né le "+e,"success").then(()=>{document.location.reload(!0)})},error:function(e){console.log("toto: ",e),swal("Erreur!","Mauvais format","warning").then(()=>{})}})}})}),$("#phone-btn").click(function(){swal("Quelle est votre nuémro de téléphone ? (10 chiffres)",{content:"input"}).then(e=>{/^\d+$/.test(e)&&10==e.length&&"0"==e[0]?e&&swal("Succès!","Votre numéro est le: "+e,"success").then(()=>{let a={phone:e};$.ajax({url:$apiUrl+"/user/"+window.localStorage.getItem("user_id"),headers:{Authorization:`Bearer ${token}`},type:"PUT",data:a,dataType:"json",success:function(e){console.log(e),document.location.reload(!0)}})}):(console.log("test"),swal("Erreur!","Mauvais format","warning").then(e=>{}))})}),$("#delivery-btn").click(function(){$.ajax({url:$apiUrl+"/cooker/"+window.localStorage.getItem("cooker_id"),headers:{Authorization:`Bearer ${token}`},type:"GET",dataType:"json",success:function(e){console.log(e);let a={delivery:0==e.delivery?1:0};$.ajax({url:$apiUrl+"/cooker/"+window.localStorage.getItem("cooker_id"),headers:{Authorization:`Bearer ${token}`},type:"PUT",data:a,dataType:"json",success:function(e){console.log(e),document.location.reload(!0)}})}})})}function remove_product(e){var a=window.localStorage.getItem("BearerToken");$.ajax({type:"DELETE",url:$apiUrl+"/dish/"+e,headers:{Authorization:`Bearer ${a}`},success:function(e){swal("Bravo!","Votre plât a été supprimé!","success").then(e=>{window.location=$webUrl+"/profil"})},error:function(e){console.log(e)}})}function build_dishes(e,a){for(var o,t=0;t<Object.keys(a).length;t++)if(a[t].cooker_id==e.cooker_id){var i='<a class="img-prod"><img class="img-fluid" src="images/'+a[t].photo_path+'" alt="Colorlib Template"><div class="overlay"></div></a>';a[t].photo_content&&(i='<a class="img-prod"><img class="img-fluid" src="data:image/jpeg;base64,'+a[t].photo_content+'" alt="Colorlib Template"><div class="overlay"></div></a>');o='<div class="col-md-6 col-lg-3"><div class="product">'+i+'<div class="text py-3 pb-4 px-3 text-center">'+('<h3><a href="#">'+a[t].name+"</a></h3>")+('<div class="d-flex"><div class="pricing"><p class="price"><span class="price-sale">'+a[t].price+"€</span></p></div></div>")+'<div class="bottom-area d-flex px-3"><div class="m-auto d-flex"><a href="#" class="add-to-cart d-flex justify-content-center align-items-center text-center"><span><i class="ion-ios-menu"></i></span></a>'+('<a type=button id="'+a[t].id+'" onclick="remove_product(this.id)" class="buy-now d-flex justify-content-center align-items-center mx-1"><span class="iconify" data-icon="akar-icons:cross" data-inline="false"></span></a>')+'<a href="#" class="heart d-flex justify-content-center align-items-center "><span><i class="ion-ios-heart"></i></span></a></div></div></div></div>',$("#profil_dish").append(o)}}function build_desc(e){var a='<div class="row justify-content-end"><div class="col-md-6 heading-section">'+('<span class="subheading">'+e.first_name+" "+e.last_name+"</span>")+'<h2 class="mb-4">Description du Cuisinier</h2>'+("<p>"+e.description+"</p>")+"</div></div>";$("#profil_desc").append(a)}$(document).ready(function(){var e=window.localStorage.getItem("user_id");$.ajax({url:$apiUrl+"/user/"+e,headers:{Authorization:`Bearer ${token}`},type:"GET",dataType:"json",success:function(e){var a=e;$.ajax({url:$apiUrl+"/dish",headers:{Authorization:`Bearer ${token}`},type:"GET",dataType:"json",success:function(e){console.log(e),build_headder(a),build_dishes(a,e),build_desc(a)}}),console.log(e)}}),$("#desc-btn").click(function(){swal("Tapez votre nouvelle description",{content:"input"}).then(e=>{e&&swal("Succès!","Description modifié!","success").then(()=>{let a={description:e};$.ajax({url:$apiUrl+"/user/"+window.localStorage.getItem("user_id"),headers:{Authorization:`Bearer ${token}`},type:"PUT",data:a,dataType:"json",success:function(e){console.log(e),document.location.reload(!0)}})})})})});

function close_command(){var o=window.localStorage.getItem("BearerToken");$.ajax({url:$apiUrl+"/command/"+window.localStorage.getItem("command_id"),headers:{Authorization:`Bearer ${o}`},type:"PUT",data:{command_status_id:1},async:!1,dataType:"json",success:function(o){window.localStorage.removeItem("command_id"),window.localStorage.removeItem("command_qty"),console.log(o)},error:function(o){console.log(o)}})}function update_local_storage(o){o.customer_id&&(window.localStorage.removeItem("customer_id"),window.localStorage.setItem("customer_id",o.customer_id)),o.cooker_id&&(window.localStorage.removeItem("cooker_id"),window.localStorage.setItem("cooker_id",o.cooker_id)),o.id&&(window.localStorage.removeItem("user_id"),window.localStorage.setItem("user_id",o.id)),swal("Bravo!","Vous êtes connecté!","success").then(o=>{window.location=$webUrl+"/choice"})}function get_login(o){var e=o.bearerToken;e&&(window.localStorage.removeItem("BearerToken"),window.localStorage.setItem("BearerToken",e),$.ajax({type:"GET",url:$apiUrl+"/user/current/"+$("#auth-mail").val(),success:function(o){update_local_storage(o)},error:function(o){console.log(o)}}))}function post_login(){let o={email:$("#auth-mail").val(),password:$("#auth-password").val()};$.ajax({type:"POST",url:$apiUrl+"/user/login",data:o,success:function(o){get_login(o)},error:function(o){swal("Erreur!","Mauvais login / mot de passe","warning").then(o=>{window.location=$webUrl+"/login"})}})}$(document).ready(function(){close_command(),$("#login-btn").click(function(){post_login()}),$("#recover-btn").click(function(){let o={email:$("#recover-email").val()};$.ajax({type:"POST",url:$apiUrl+"/password_reset/notify",data:o,success:function(o){console.log(o),$("#recover-btn-box").attr("hidden","hidden"),$("#recover-sended-txt").removeAttr("hidden")},error:function(o){console.log(o)}})}),$("#reset-btn").click(function(){let o={token:$("#reset-token").val(),password:$("#reset-password").val(),password_confirmation:$("#reset-password-confirmation").val()};$.ajax({type:"POST",url:$apiUrl+"/password_reset/save",data:o,success:function(o){console.log(o),window.location=$webUrl+"/landing"},error:function(o){console.log(o)}})})});
